{"version":3,"sources":["app.js"],"names":["socket","io","Engine","Matter","Render","Runner","Body","Query","Events","Composite","Composites","Constraint","MouseConstraint","Mouse","World","Vector","Bounds","Bodies","engine","create","world","frontVersion","render","element","document","body","options","width","window","innerWidth","height","innerHeight","showAngleIndicator","showCollisions","showVelocity","wireframes","angles","background","run","runner","gravity","y","towerHeight","clientsCount","group","nextGroup","group2","Head","head","position","x","xScale","yScale","HairBody","hair","Hair","createConstraint","EyeBody","eyes","eyeradius","pupilradius","eyecolor","pupilcolor","Eye","addChain","countChain","RectHair","recthair","Hat","hat","Text","text","remove","i","setContext","cc","isNaN","setContect","bodies","length","Number","toFixed","UpdateClick","textincdec","stack","incTowerHeight","rectangle","collisionFilter","label","fillStyle","content","color","size","family","frictionAir","applyForce","clear","add","emit","decTowerHeight","removeOneChain","removeChain","addOneChain","UpdateUsers","count","querySelector","textContent","firststart","translate","bounds","max","setInterval","lastcountChain","Math","floor","on","mouse","canvas","mouseConstraint","constraint","stiffness","visible","mouseCoord","e","cursorLook","btnclick","allBodies","point","setTimeout","audio","Audio","src","play","addEventListener","bool","forEach","compound","rand","getRandomFloat","setAngularVelocity","lookAt","min","viewportCentre","boundsScaleTarget","boundsScale","animid","random","getRandomInt","hidden","bgMusicplay","pause","toggle","scaleFactor","wheelDelta","abs","sprite","texture"],"mappings":"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","file":"app.aed56e7f.js","sourceRoot":"..","sourcesContent":["const socket = io()\r\n\r\nconst \r\n    Engine = Matter.Engine,\r\n    Render = Matter.Render,\r\n    Runner = Matter.Runner,\r\n    Body = Matter.Body,\r\n    Query = Matter.Query,\r\n    Events = Matter.Events,\r\n    Composite = Matter.Composite,\r\n    Composites = Matter.Composites,\r\n    Constraint = Matter.Constraint,\r\n    MouseConstraint = Matter.MouseConstraint,\r\n    Mouse = Matter.Mouse,\r\n    World = Matter.World,\r\n    Vector = Matter.Vector,\r\n    Bounds = Matter.Bounds,\r\n    Bodies = Matter.Bodies\r\n\r\n// create engine\r\nconst \r\n    engine = Engine.create(),\r\n    world = engine.world\r\n    \r\nconst\r\n    frontVersion = 'JQaZmv15'\r\n\r\n// create renderer\r\nconst render = Render.create({\r\n    element: document.body,\r\n    engine: engine,\r\n    options: {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n        showAngleIndicator: false,\r\n        showCollisions: false,\r\n        showVelocity: false,\r\n        wireframes: false,\r\n        angles: false,\r\n        background: '#E2ECF5'\r\n    }\r\n})\r\n\r\nRender.run(render)\r\n\r\n// create runner\r\nconst runner = Runner.create()\r\nRunner.run(runner, engine)\r\n\r\nworld.gravity.y = 0\r\n\r\nlet towerHeight = 0,\r\n    clientsCount = 0\r\n\r\n// add bodies\r\nconst group = Body.nextGroup(true)\r\nconst group2 = Body.nextGroup(true)\r\n\r\n//create head\r\nconst Head = new head({\r\n    position: {x: 349, y: 410},\r\n    xScale: .57,\r\n    yScale: .58\r\n}).create()\r\n\r\n\r\n\r\n//create hair and constraint\r\nconst HairBody = new hair({\r\n    position: {x: 350, y: 320}\r\n})\r\nconst Hair = HairBody.create()\r\nHairBody.createConstraint(Hair)\r\n\r\n\r\nconst EyeBody = new eyes({\r\n    position: {x: 327, y: 400},\r\n    eyeradius: 8,\r\n    pupilradius: 4.5,\r\n    eyecolor: '#F4F3EE',\r\n    pupilcolor: '#1F2E37'\r\n})\r\nconst Eye = EyeBody.create()\r\n\r\n\r\nconst addChain = (countChain) => {\r\n    const RectHair = new recthair()\r\n    const Hat = new hat()\r\n    const Text = new text()\r\n    \r\n    Text.remove(Hair)\r\n    Hat.remove(Hair)\r\n    RectHair.remove(Hair)\r\n    if(countChain != 0) {\r\n\r\n        // add chain to hair\r\n        for(let i = 0; i <= countChain - 1; i++) {\r\n            HairBody.addChain(Hair)\r\n        }\r\n    }\r\n    RectHair.create(Hair)\r\n    Hat.create(Hair)\r\n    Text.create(Hair)\r\n    setContext(towerHeight)\r\n}\r\n\r\nfunction setContext (cc) {\r\n    const Text = new text()\r\n    if(!isNaN(cc)) {\r\n        Text.setContect(Hair.bodies[Hair.bodies.length - 1], Number(cc).toFixed(3))\r\n    } else {\r\n        Text.setContect(Hair.bodies[Hair.bodies.length - 1], cc)\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction UpdateClick(cc) {\r\n    if(cc < 0) { \r\n        towerHeight = 0\r\n        return\r\n    }\r\n    towerHeight = cc\r\n    setContext(towerHeight)\r\n}\r\n\r\nconst textincdec = Composites.stack(0, 0, 1, 1, 10, 10, () => {}) \r\nWorld.add(world, textincdec)\r\n\r\nfunction incTowerHeight () {\r\n    \r\n    const body = Bodies.rectangle(Hair.bodies[Hair.bodies.length - 1].position.x, Hair.bodies[Hair.bodies.length - 1].position.y, 35, 35, { \r\n        collisionFilter: { group: group, group: group2 },\r\n        label: 'pointinc',\r\n        render: {\r\n            fillStyle: \"#E2ECF5\",\r\n            text:{\r\n                content: \"+1\",\r\n                color: \"#96CE73\",\r\n                size: 24,\r\n                family: \"Comfortaa\",\r\n            },\r\n        },\r\n        frictionAir: 0.3\r\n    });\r\n    Body.applyForce(body, {x: body.position.x, y: body.position.y}, {x: 0, y: -.05})\r\n    if(textincdec.bodies.length) {\r\n        Composite.clear(textincdec)\r\n    }\r\n    Composite.add(textincdec, body) \r\n\r\n\r\n    UpdateClick(towerHeight + 0.001)\r\n    socket.emit('clickInc')\r\n}\r\n\r\nfunction decTowerHeight () {\r\n    const body = Bodies.rectangle(Hair.bodies[Hair.bodies.length - 1].position.x, Hair.bodies[Hair.bodies.length - 1].position.y, 35, 35, { \r\n        collisionFilter: { group: group, group: group2 },\r\n        label: 'pointinc',\r\n        render: {\r\n            fillStyle: \"#E2ECF5\",\r\n            text:{\r\n                content: \"-3\",\r\n                color: \"#CE7373\",\r\n                size: 24,\r\n                family: \"Comfortaa\",\r\n            },\r\n        },\r\n        frictionAir: 0.3\r\n    });\r\n    Body.applyForce(body, {x: body.position.x, y: body.position.y}, {x: 0, y: -.05})\r\n    if(textincdec.bodies.length) {\r\n        Composite.clear(textincdec)\r\n    }\r\n    Composite.add(textincdec, body) \r\n\r\n\r\n\r\n    if(towerHeight <= 0) return\r\n    UpdateClick(towerHeight - 0.003)\r\n    if(towerHeight < 0) towerHeight = 0\r\n    socket.emit('clickDec')\r\n}\r\n\r\nfunction removeOneChain () {\r\n    if(towerHeight <= 20) return\r\n    HairBody.removeChain(Hair)\r\n    setContext(towerHeight)\r\n}\r\n\r\n\r\n\r\nconst addOneChain = () => {\r\n    const RectHair = new recthair()\r\n    const Hat = new hat()\r\n    const Text = new text()\r\n    \r\n    Text.remove(Hair)\r\n    Hat.remove(Hair)\r\n    RectHair.remove(Hair)\r\n    \r\n    HairBody.addChain(Hair)\r\n    RectHair.create(Hair)\r\n    Hat.create(Hair)\r\n    Text.create(Hair)\r\n    setContext(towerHeight)\r\n}\r\nsetInterval(() => {\r\n    if(textincdec.bodies.length) {\r\n            Composite.remove(textincdec, textincdec.bodies[0])\r\n        // setTimeout(() => {\r\n        // }, 2000);\r\n    }\r\n\r\n\r\n    let lastcountChain = Hair.bodies.length - 3\r\n    let countChain = towerHeight / 20 \r\n    countChain = Math.floor(countChain) \r\n    if(lastcountChain < countChain) {\r\n        addOneChain()\r\n        lastcountChain = countChain\r\n    } else if(lastcountChain > countChain) {\r\n        removeOneChain()\r\n        lastcountChain = countChain\r\n    }\r\n\r\n}, 1000);\r\n\r\nnew recthair().create(Hair)\r\nnew hat().create(Hair)\r\nnew text().create(Hair)\r\n\r\n\r\n//add objects\r\nWorld.add(world, [Head, Hair, Eye])\r\n\r\nfunction UpdateUsers(count) {\r\n    clientsCount = count\r\n    document.querySelector('.users-online').textContent = `Онлайн: ${clientsCount}`\r\n}\r\n\r\nsocket.on('connection', (cc) => {\r\n    socket.emit('frontVer', frontVersion)\r\n    UpdateClick(cc)\r\n    let countChain = cc / 20 \r\n    countChain = Math.floor(countChain) - 1\r\n    addChain(countChain)\r\n    firststart()\r\n})\r\n\r\nfunction firststart() {\r\n    let translate = {\r\n        x: 0,\r\n        y: Hair.bodies[Hair.bodies.length - 1].bounds.max.y - 200\r\n    }\r\n\r\n    if (render.bounds.max.y + translate.y > world.bounds.max.y)\r\n        translate.y = world.bounds.max.y - render.bounds.max.y;\r\n        \r\n    Bounds.translate(render.bounds, translate)\r\n}\r\nsocket.on('frontVer', frontVersion)\r\nsocket.on('clickInc', UpdateClick)\r\nsocket.on('clickDec', UpdateClick)\r\nsocket.on('autoDec', UpdateClick)\r\nsocket.on('updateUserCount', UpdateUsers)\r\n\r\n\r\n// add mouse control\r\nconst \r\n    mouse = Mouse.create(render.canvas),\r\n    mouseConstraint = MouseConstraint.create(engine, {\r\n        mouse: mouse,\r\n        constraint: {\r\n            stiffness: 0.001,\r\n            render: {\r\n                visible: false\r\n            }\r\n        }\r\n    });\r\n    \r\nlet mouseCoord = { x: 0, y: 0 }\r\n\r\n// add events \r\nEvents.on(mouseConstraint, \"mousemove\", (e) => {\r\n    mouseCoord.x = e.mouse.position.x\r\n    mouseCoord.y = e.mouse.position.y\r\n    EyeBody.cursorLook(Eye.bodies[2], Eye.bodies[3], mouseCoord)\r\n    \r\n})\r\nlet btnclick = false\r\nEvents.on(mouseConstraint, \"enddrag\", (e) => {\r\n    let bodies = Composite.allBodies(engine.world)\r\n    let point = Query.point(bodies, e.mouse.position)\r\n\r\n    if(e.body.label != 'glad' && e.body.label != 'pointinc') {\r\n        if(point.length == 0) {\r\n\r\n            btnclick = true\r\n            setTimeout(() => {\r\n                btnclick = false\r\n            }, 500);\r\n    \r\n            const audio = new Audio()\r\n            audio.src = 'sounds/tap.mp3'\r\n            audio.play()\r\n    \r\n            decTowerHeight()\r\n        }\r\n    }\r\n})\r\n\r\ndocument.addEventListener('click', () => {\r\n    let bodies = Composite.allBodies(engine.world)\r\n    let point = Query.point(bodies, mouseConstraint.mouse.position)\r\n    let bool = true\r\n    // if(point.length != 0) {\r\n    // }\r\n    point.forEach(function(body){\r\n        if(body.label != 'glad' && body.label != 'pointinc' && bool ) {\r\n            let compound = Hair.bodies[Hair.bodies.length - 4]\r\n            btnclick = true\r\n            setTimeout(() => {\r\n                btnclick = false\r\n            }, 500);\r\n    \r\n            const audio = new Audio()\r\n            audio.src = 'sounds/tap.mp3'\r\n            audio.play()\r\n    \r\n            let rand = getRandomFloat(-.05, .05)\r\n            Body.setAngularVelocity(compound, rand);\r\n            Body.applyForce(compound, compound.position, {x: rand, y: 0})\r\n            incTowerHeight()\r\n            bool = false\r\n        }\r\n    });\r\n})\r\n\r\n// add mouse\r\nWorld.add(world, mouseConstraint);\r\n\r\n// keep the mouse in sync with rendering\r\nrender.mouse = mouse;\r\n\r\n// fit the render viewport to the scene\r\nRender.lookAt(render, {\r\n    min: { x: 0, y: 0 },\r\n    max: { x: 700, y: 600 }\r\n});\r\n\r\n// get the centre of the viewport\r\nlet viewportCentre = {\r\n    x: render.options.width * 0.5,\r\n    y: render.options.height * 0.5\r\n};\r\n\r\n// make the world bounds a little bigger than the render bounds\r\nworld.bounds.min.y = -300;\r\nworld.bounds.max.y = 600;\r\n\r\n// keep track of current bounds scale (view zoom)\r\nlet boundsScaleTarget = 1,\r\n    boundsScale = {\r\n        x: 1,\r\n        y: 1\r\n    },\r\n    animid = 0\r\n\r\ndocument.addEventListener( 'visibilitychange' , function() {\r\n    if (document.hidden) {\r\n        bgMusicplay.pause()\r\n        \r\n    } else if(!document.hidden && toggle != false ) {\r\n        bgMusicplay.play()\r\n    }\r\n}, true );\r\n\r\n// use the engine tick event to control our view\r\nEvents.on(engine, 'beforeTick', function() {\r\n    var world = engine.world,\r\n        mouse = mouseConstraint.mouse,\r\n        translate;\r\n    \r\n    // mouse wheel controls zoom\r\n    var scaleFactor = mouse.wheelDelta * -0.1;\r\n    if (scaleFactor !== 0) {\r\n        if ((scaleFactor < 0 && boundsScale.x >= 0.6) || (scaleFactor > 0 && boundsScale.x <= 1.4)) {\r\n            boundsScaleTarget += scaleFactor;\r\n        }\r\n    }\r\n    \r\n    // if scale has changed\r\n    if (Math.abs(boundsScale.x - boundsScaleTarget) > 0.01) {\r\n        scaleFactor = (boundsScaleTarget - boundsScale.y) * 0.2;\r\n\r\n        boundsScale.y += scaleFactor;\r\n\r\n        translate = {\r\n            x: 0,\r\n            y: render.options.height * scaleFactor * 0.5\r\n        };\r\n        if (render.bounds.max.y + translate.y > world.bounds.max.y)\r\n            translate.y = world.bounds.max.y - render.bounds.max.y;\r\n\r\n        Bounds.translate(render.bounds, translate);\r\n    }\r\n    \r\n    if(towerHeight <= 0 && btnclick != true) {\r\n        Head.render.sprite.texture = 'img/head0_ny.png'\r\n        animid = 1\r\n        Head.position.y = 426;\r\n        Hair.bodies[2].render.visible = false;\r\n        Hair.bodies[1].render.visible = false;\r\n        Hair.bodies[0].render.visible = false;\r\n    } else if(towerHeight >= 0 && btnclick != true) {\r\n        Head.render.sprite.texture = 'img/head_ny.png'\r\n        animid = 2\r\n        Head.position.y = 442;\r\n        Hair.bodies[2].render.visible = true;\r\n        Hair.bodies[1].render.visible = true;\r\n        Hair.bodies[0].render.visible = true;\r\n    } \r\n    if(animid == 1 && btnclick == true) {\r\n        Head.position.y = 424;\r\n        Head.render.sprite.texture = 'img/head0A_ny.png'\r\n    } else if(animid == 2 && btnclick == true) {\r\n        Head.position.y = 440;\r\n        Head.render.sprite.texture = 'img/headA_ny.png'\r\n    }\r\n    \r\n    if(towerHeight <= 0) {\r\n        setContext('У вас 0')\r\n    }\r\n});\r\n\r\nfunction getRandomFloat(min, max) {\r\n    return Math.random() * (max - min) + min;\r\n}\r\n\r\nfunction getRandomInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}"]}